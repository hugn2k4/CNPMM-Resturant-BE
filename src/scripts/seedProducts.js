"use strict";

import dotenv from "dotenv";
import mongoose from "mongoose";
import Category from "../models/category.js";
import Image from "../models/image.js";
import Product from "../models/product.js";

// Load environment variables
dotenv.config();

const connectDB = async () => {
  try {
    const mongoUri = process.env.MONGO_URI || process.env.MONGODB_URI || "mongodb://127.0.0.1:27017/node_fulltask";
    console.log("üîå Connecting to:", mongoUri);
    await mongoose.connect(mongoUri);
    console.log("‚úÖ MongoDB connected");
  } catch (error) {
    console.error("‚ùå MongoDB connection error:", error);
    process.exit(1);
  }
};

const seedData = async () => {
  try {
    console.log("üóëÔ∏è  ƒêang x√≥a d·ªØ li·ªáu c≈©...");
    await Product.deleteMany({});
    await Category.deleteMany({});
    await Image.deleteMany({});

    // T·∫°o Categories
    console.log("üìÅ ƒêang t·∫°o categories...");
    const categoriesData = [
      { name: "M√≥n ch√≠nh", slug: "mon-chinh", description: "C√°c m√≥n ƒÉn ch√≠nh", isActive: true },
      { name: "Khai v·ªã", slug: "khai-vi", description: "M√≥n khai v·ªã", isActive: true },
      { name: "Tr√°ng mi·ªáng", slug: "trang-mieng", description: "M√≥n tr√°ng mi·ªáng", isActive: true },
      { name: "ƒê·ªì u·ªëng", slug: "do-uong", description: "N∆∞·ªõc u·ªëng c√°c lo·∫°i", isActive: true },
      { name: "Salad", slug: "salad", description: "Salad t∆∞∆°i ngon", isActive: true },
    ];
    const categories = await Category.insertMany(categoriesData);

    // T·∫°o Images v·ªõi Unsplash URLs
    console.log("üñºÔ∏è  ƒêang t·∫°o images...");
    const imagesData = [
      { url: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800", alt: "Salad t∆∞∆°i" },
      { url: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=800", alt: "Pizza" },
      { url: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=800", alt: "Burger" },
      { url: "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?w=800", alt: "M√≥n ƒÉn" },
      { url: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800", alt: "B·ªØa s√°ng" },
      { url: "https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=800", alt: "Pancakes" },
      { url: "https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800", alt: "Salad b√°t" },
      { url: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=800", alt: "Healthy" },
      { url: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800", alt: "Pasta" },
      { url: "https://images.unsplash.com/photo-1551782450-a2132b4ba21d?w=800", alt: "Sushi" },
      { url: "https://images.unsplash.com/photo-1600891964092-4316c288032e?w=800", alt: "Cocktail" },
      { url: "https://images.unsplash.com/photo-1563636619-e9143da7973b?w=800", alt: "Smoothie" },
      { url: "https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=800", alt: "Dessert" },
      { url: "https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=800", alt: "Soup" },
      { url: "https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=800", alt: "Steak" },
    ];
    const images = await Image.insertMany(imagesData);

    // G√°n ƒëa ·∫£nh cho m·ªói s·∫£n ph·∫©m (xoay v√≤ng b·ªô ·∫£nh ƒë·ªÉ lu√¥n c√≥ >=3 ·∫£nh)
    const getImagesForProduct = (index) => {
      const len = images.length;
      const i = index % len;
      return [
        images[i]._id,
        images[(i + 1) % len]._id,
        images[(i + 2) % len]._id,
      ];
    };

    // D·ªØ li·ªáu s·∫£n ph·∫©m th·ª±c t·∫ø
    console.log("üçî ƒêang t·∫°o products...");

    const productsData = [
      // M√ìN CH√çNH - Best sellers
      {
        name: "B√≤ b√≠t t·∫øt √öc cao c·∫•p",
        description: "Th·ªãt b√≤ √öc nh·∫≠p kh·∫©u, n∆∞·ªõng ch√≠n v·ª´a, ph·ª•c v·ª• k√®m khoai t√¢y nghi·ªÅn v√† rau c·ªß",
        price: 450000,
        categoryId: categories[0]._id,
        listProductImage: [images[14]._id],
        stock: 25,
        status: "available",
        preparationTime: "25-30 ph√∫t",
        calories: 680,
        rating: 4.8,
        reviewCount: 245,
        viewCount: 5200,
        soldCount: 680,
        discount: 0,
      },
      {
        name: "C∆°m g√† H·∫£i Nam",
        description: "G√† lu·ªôc m·ªÅm, c∆°m th∆°m b√©o, n∆∞·ªõc ch·∫•m ƒë·∫≠m ƒë√†",
        price: 85000,
        categoryId: categories[0]._id,
        listProductImage: [images[4]._id],
        stock: 50,
        status: "available",
        preparationTime: "20-25 ph√∫t",
        calories: 520,
        rating: 4.7,
        reviewCount: 389,
        viewCount: 8500,
        soldCount: 1250,
        discount: 15,
      },
      {
        name: "Spaghetti Carbonara",
        description: "M√¨ √ù s·ªët kem tr·ª©ng, th·ªãt x√¥ng kh√≥i gi√≤n",
        price: 120000,
        categoryId: categories[0]._id,
        listProductImage: [images[8]._id],
        stock: 35,
        status: "available",
        preparationTime: "15-20 ph√∫t",
        calories: 580,
        rating: 4.6,
        reviewCount: 312,
        viewCount: 6800,
        soldCount: 890,
        discount: 20,
      },
      {
        name: "Burger b√≤ ph√¥ mai ƒë·∫∑c bi·ªát",
        description: "B√°nh m√¨ t·ª± l√†m, th·ªãt b√≤ Wagyu, ph√¥ mai Cheddar tan ch·∫£y",
        price: 165000,
        categoryId: categories[0]._id,
        listProductImage: [images[2]._id],
        stock: 40,
        status: "available",
        preparationTime: "18-22 ph√∫t",
        calories: 720,
        rating: 4.9,
        reviewCount: 456,
        viewCount: 9200,
        soldCount: 1580,
        discount: 10,
      },
      {
        name: "Pizza Margherita",
        description: "Pizza truy·ªÅn th·ªëng √ù v·ªõi c√† chua t∆∞∆°i, ph√¥ mai Mozzarella",
        price: 180000,
        categoryId: categories[0]._id,
        listProductImage: [images[1]._id],
        stock: 30,
        status: "available",
        preparationTime: "22-25 ph√∫t",
        calories: 640,
        rating: 4.7,
        reviewCount: 278,
        viewCount: 7100,
        soldCount: 920,
        discount: 25,
      },
      {
        name: "Sushi combo ƒë·∫∑c bi·ªát",
        description: "12 mi·∫øng sushi c√° h·ªìi, c√° ng·ª´ t∆∞∆°i s·ªëng",
        price: 320000,
        categoryId: categories[0]._id,
        listProductImage: [images[9]._id],
        stock: 20,
        status: "available",
        preparationTime: "20-25 ph√∫t",
        calories: 450,
        rating: 4.8,
        reviewCount: 198,
        viewCount: 4500,
        soldCount: 560,
        discount: 0,
      },

      // KHAI V·ªä
      {
        name: "Salad Caesar",
        description: "Rau x√† l√°ch t∆∞∆°i, ph√¥ mai Parmesan, s·ªët Caesar",
        price: 75000,
        categoryId: categories[1]._id,
        listProductImage: [images[0]._id],
        stock: 45,
        status: "available",
        preparationTime: "10-12 ph√∫t",
        calories: 280,
        rating: 4.5,
        reviewCount: 167,
        viewCount: 3200,
        soldCount: 420,
        discount: 0,
      },
      {
        name: "G·ªèi cu·ªën t√¥m th·ªãt",
        description: "G·ªèi cu·ªën t∆∞∆°i ngon, t√¥m th·ªãt ƒë·∫ßy ƒë·ªß",
        price: 55000,
        categoryId: categories[1]._id,
        listProductImage: [images[3]._id],
        stock: 60,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 180,
        rating: 4.6,
        reviewCount: 234,
        viewCount: 4800,
        soldCount: 780,
        discount: 0,
      },
      {
        name: "Soup b√≠ ƒë·ªè",
        description: "Soup b√≠ ƒë·ªè b√©o ng·∫≠y, h·∫°t ƒëi·ªÅu rang",
        price: 45000,
        categoryId: categories[1]._id,
        listProductImage: [images[13]._id],
        stock: 0,
        status: "out_of_stock",
        preparationTime: "12-15 ph√∫t",
        calories: 220,
        rating: 4.4,
        reviewCount: 89,
        viewCount: 1500,
        soldCount: 180,
        discount: 0,
      },

      // TR√ÅNG MI·ªÜNG
      {
        name: "Tiramisu √ù",
        description: "B√°nh tiramisu truy·ªÅn th·ªëng, c√† ph√™ Espresso",
        price: 65000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 25,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 320,
        rating: 4.7,
        reviewCount: 156,
        viewCount: 3400,
        soldCount: 450,
        discount: 0,
      },
      {
        name: "Pancake d√¢u t√¢y",
        description: "B√°nh pancake x·ªëp m·ªÅm, s·ªët d√¢u t√¢y t∆∞∆°i",
        price: 55000,
        categoryId: categories[2]._id,
        listProductImage: [images[5]._id],
        stock: 35,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 380,
        rating: 4.8,
        reviewCount: 289,
        viewCount: 6200,
        soldCount: 820,
        discount: 15,
      },
      {
        name: "Kem vanilla Madagascar",
        description: "Kem vanilla nguy√™n ch·∫•t t·ª´ Madagascar",
        price: 42000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 50,
        status: "available",
        preparationTime: "3 ph√∫t",
        calories: 240,
        rating: 4.6,
        reviewCount: 178,
        viewCount: 4100,
        soldCount: 620,
        discount: 0,
      },

      // ƒê·ªí U·ªêNG
      {
        name: "C√† ph√™ s·ªØa ƒë√° Vi·ªát Nam",
        description: "C√† ph√™ phin truy·ªÅn th·ªëng, s·ªØa ƒë·∫∑c ng·ªçt ng√†o",
        price: 35000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 100,
        status: "available",
        preparationTime: "5-7 ph√∫t",
        calories: 180,
        rating: 4.9,
        reviewCount: 567,
        viewCount: 12000,
        soldCount: 2300,
        discount: 0,
      },
      {
        name: "Sinh t·ªë b∆°",
        description: "Sinh t·ªë b∆° s√°nh m·ªãn, b·ªï d∆∞·ª°ng",
        price: 45000,
        categoryId: categories[3]._id,
        listProductImage: [images[11]._id],
        stock: 80,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 280,
        rating: 4.7,
        reviewCount: 412,
        viewCount: 8900,
        soldCount: 1450,
        discount: 0,
      },
      {
        name: "Tr√† s·ªØa tr√¢n ch√¢u ƒë∆∞·ªùng ƒëen",
        description: "Tr√† s·ªØa th∆°m ngon, tr√¢n ch√¢u m·ªÅm d·∫ªo",
        price: 42000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 120,
        status: "available",
        preparationTime: "7-8 ph√∫t",
        calories: 320,
        rating: 4.8,
        reviewCount: 689,
        viewCount: 15000,
        soldCount: 2800,
        discount: 20,
      },
      {
        name: "N∆∞·ªõc √©p cam t∆∞∆°i",
        description: "Cam t∆∞∆°i v·∫Øt 100%, kh√¥ng ƒë∆∞·ªùng",
        price: 38000,
        categoryId: categories[3]._id,
        listProductImage: [images[11]._id],
        stock: 0,
        status: "out_of_stock",
        preparationTime: "5 ph√∫t",
        calories: 120,
        rating: 4.6,
        reviewCount: 234,
        viewCount: 5200,
        soldCount: 980,
        discount: 0,
      },

      // SALAD
      {
        name: "Salad Hy L·∫°p",
        description: "C√† chua bi, d∆∞a chu·ªôt, ph√¥ mai Feta, olive ƒëen",
        price: 85000,
        categoryId: categories[4]._id,
        listProductImage: [images[6]._id],
        stock: 30,
        status: "available",
        preparationTime: "10 ph√∫t",
        calories: 240,
        rating: 4.7,
        reviewCount: 145,
        viewCount: 3100,
        soldCount: 380,
        discount: 0,
      },
      {
        name: "Salad rau c·ªß qu·∫£ h·ªón h·ª£p",
        description: "Rau c·ªß qu·∫£ t∆∞∆°i, s·ªët d·∫ßu olive",
        price: 70000,
        categoryId: categories[4]._id,
        listProductImage: [images[7]._id],
        stock: 40,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 180,
        rating: 4.5,
        reviewCount: 178,
        viewCount: 3800,
        soldCount: 520,
        discount: 30,
      },

      // M√ìN CH√çNH - Th√™m m·ªõi
      {
        name: "C∆°m t·∫•m s∆∞·ªùn n∆∞·ªõng",
        description: "C∆°m t·∫•m th∆°m, s∆∞·ªùn n∆∞·ªõng m·∫≠t ong, ch·∫£ tr·ª©ng",
        price: 95000,
        categoryId: categories[0]._id,
        listProductImage: [images[4]._id],
        stock: 55,
        status: "available",
        preparationTime: "18-22 ph√∫t",
        calories: 650,
        rating: 4.6,
        reviewCount: 423,
        viewCount: 7800,
        soldCount: 1100,
        discount: 10,
      },
      {
        name: "Ph·ªü b√≤ t√°i ch√≠n",
        description: "Ph·ªü truy·ªÅn th·ªëng, th·ªãt b√≤ t√°i ch√≠n, n∆∞·ªõc d√πng ƒë·∫≠m ƒë√†",
        price: 80000,
        categoryId: categories[0]._id,
        listProductImage: [images[13]._id],
        stock: 60,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 480,
        rating: 4.8,
        reviewCount: 512,
        viewCount: 9500,
        soldCount: 1350,
        discount: 0,
      },
      {
        name: "B√∫n ch·∫£ H√† N·ªôi",
        description: "B√∫n ch·∫£ truy·ªÅn th·ªëng, th·ªãt n∆∞·ªõng th∆°m l·ª´ng",
        price: 75000,
        categoryId: categories[0]._id,
        listProductImage: [images[3]._id],
        stock: 50,
        status: "available",
        preparationTime: "15-18 ph√∫t",
        calories: 420,
        rating: 4.7,
        reviewCount: 389,
        viewCount: 8200,
        soldCount: 980,
        discount: 15,
      },
      {
        name: "Pizza Pepperoni",
        description: "Pizza v·ªõi pepperoni cay, ph√¥ mai Mozzarella tan ch·∫£y",
        price: 195000,
        categoryId: categories[0]._id,
        listProductImage: [images[1]._id],
        stock: 28,
        status: "available",
        preparationTime: "20-25 ph√∫t",
        calories: 720,
        rating: 4.6,
        reviewCount: 234,
        viewCount: 6500,
        soldCount: 720,
        discount: 20,
      },
      {
        name: "Pizza H·∫£i s·∫£n",
        description: "Pizza v·ªõi t√¥m, m·ª±c, c√° h·ªìi t∆∞∆°i ngon",
        price: 220000,
        categoryId: categories[0]._id,
        listProductImage: [images[1]._id],
        stock: 25,
        status: "available",
        preparationTime: "22-28 ph√∫t",
        calories: 680,
        rating: 4.7,
        reviewCount: 198,
        viewCount: 5800,
        soldCount: 650,
        discount: 0,
      },
      {
        name: "Pasta Bolognese",
        description: "M√¨ √ù s·ªët th·ªãt b√≤ bƒÉm, c√† chua t∆∞∆°i",
        price: 135000,
        categoryId: categories[0]._id,
        listProductImage: [images[8]._id],
        stock: 32,
        status: "available",
        preparationTime: "18-22 ph√∫t",
        calories: 620,
        rating: 4.5,
        reviewCount: 267,
        viewCount: 5900,
        soldCount: 780,
        discount: 15,
      },
      {
        name: "Pasta Marinara",
        description: "M√¨ √ù s·ªët c√† chua t∆∞∆°i, t·ªèi, h√∫ng qu·∫ø",
        price: 110000,
        categoryId: categories[0]._id,
        listProductImage: [images[8]._id],
        stock: 38,
        status: "available",
        preparationTime: "15-18 ph√∫t",
        calories: 480,
        rating: 4.4,
        reviewCount: 189,
        viewCount: 4200,
        soldCount: 540,
        discount: 0,
      },
      {
        name: "C∆°m chi√™n D∆∞∆°ng Ch√¢u",
        description: "C∆°m chi√™n v·ªõi t√¥m, th·ªãt, tr·ª©ng, rau c·ªß",
        price: 90000,
        categoryId: categories[0]._id,
        listProductImage: [images[4]._id],
        stock: 45,
        status: "available",
        preparationTime: "15-20 ph√∫t",
        calories: 580,
        rating: 4.6,
        reviewCount: 312,
        viewCount: 6800,
        soldCount: 890,
        discount: 10,
      },
      {
        name: "B√°nh m√¨ th·ªãt n∆∞·ªõng",
        description: "B√°nh m√¨ gi√≤n, th·ªãt n∆∞·ªõng th∆°m, pate, rau c·ªß",
        price: 55000,
        categoryId: categories[0]._id,
        listProductImage: [images[2]._id],
        stock: 70,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 420,
        rating: 4.8,
        reviewCount: 678,
        viewCount: 11200,
        soldCount: 1890,
        discount: 0,
      },
      {
        name: "B√°nh x√®o t√¥m th·ªãt",
        description: "B√°nh x√®o gi√≤n, t√¥m th·ªãt ƒë·∫ßy ƒë·ªß, rau s·ªëng",
        price: 70000,
        categoryId: categories[0]._id,
        listProductImage: [images[3]._id],
        stock: 40,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 450,
        rating: 4.7,
        reviewCount: 445,
        viewCount: 7800,
        soldCount: 1120,
        discount: 0,
      },
      {
        name: "C√° h·ªìi n∆∞·ªõng s·ªët teriyaki",
        description: "C√° h·ªìi t∆∞∆°i n∆∞·ªõng, s·ªët teriyaki ng·ªçt ƒë·∫≠m ƒë√†",
        price: 280000,
        categoryId: categories[0]._id,
        listProductImage: [images[9]._id],
        stock: 18,
        status: "available",
        preparationTime: "20-25 ph√∫t",
        calories: 520,
        rating: 4.9,
        reviewCount: 234,
        viewCount: 5200,
        soldCount: 450,
        discount: 0,
      },
      {
        name: "G√† n∆∞·ªõng m·∫≠t ong",
        description: "G√† nguy√™n con n∆∞·ªõng m·∫≠t ong, th∆°m l·ª´ng",
        price: 320000,
        categoryId: categories[0]._id,
        listProductImage: [images[4]._id],
        stock: 15,
        status: "available",
        preparationTime: "35-40 ph√∫t",
        calories: 780,
        rating: 4.7,
        reviewCount: 178,
        viewCount: 4100,
        soldCount: 320,
        discount: 25,
      },
      {
        name: "L·∫©u Th√°i chua cay",
        description: "L·∫©u Th√°i ƒë·∫≠m ƒë√†, t√¥m c√° t∆∞∆°i, rau c·ªß",
        price: 350000,
        categoryId: categories[0]._id,
        listProductImage: [images[13]._id],
        stock: 12,
        status: "available",
        preparationTime: "30 ph√∫t",
        calories: 450,
        rating: 4.8,
        reviewCount: 156,
        viewCount: 3800,
        soldCount: 280,
        discount: 0,
      },
      {
        name: "B√°nh m√¨ k·∫πp th·ªãt n∆∞·ªõng",
        description: "Burger Vi·ªát Nam, th·ªãt n∆∞·ªõng ƒë·∫≠m ƒë√†",
        price: 65000,
        categoryId: categories[0]._id,
        listProductImage: [images[2]._id],
        stock: 55,
        status: "available",
        preparationTime: "10-12 ph√∫t",
        calories: 480,
        rating: 4.6,
        reviewCount: 389,
        viewCount: 7200,
        soldCount: 980,
        discount: 0,
      },

      // KHAI V·ªä - Th√™m m·ªõi
      {
        name: "Nem n∆∞·ªõng Nha Trang",
        description: "Nem n∆∞·ªõng th∆°m l·ª´ng, ch·∫•m m·∫Øm n√™m",
        price: 65000,
        categoryId: categories[1]._id,
        listProductImage: [images[3]._id],
        stock: 50,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 320,
        rating: 4.7,
        reviewCount: 289,
        viewCount: 5600,
        soldCount: 720,
        discount: 0,
      },
      {
        name: "Ch·∫£ gi√≤",
        description: "Ch·∫£ gi√≤ gi√≤n r·ª•m, nh√¢n t√¥m th·ªãt ƒë·∫ßy ƒë·ªß",
        price: 60000,
        categoryId: categories[1]._id,
        listProductImage: [images[3]._id],
        stock: 55,
        status: "available",
        preparationTime: "10-12 ph√∫t",
        calories: 280,
        rating: 4.6,
        reviewCount: 312,
        viewCount: 6100,
        soldCount: 890,
        discount: 10,
      },
      {
        name: "Soup cua",
        description: "Soup cua b√©o ng·∫≠y, th·ªãt cua t∆∞∆°i",
        price: 50000,
        categoryId: categories[1]._id,
        listProductImage: [images[13]._id],
        stock: 40,
        status: "available",
        preparationTime: "15-18 ph√∫t",
        calories: 240,
        rating: 4.5,
        reviewCount: 198,
        viewCount: 3800,
        soldCount: 540,
        discount: 0,
      },
      {
        name: "Soup g√† n·∫•m",
        description: "Soup g√† n·∫•m th∆°m ngon, b·ªï d∆∞·ª°ng",
        price: 48000,
        categoryId: categories[1]._id,
        listProductImage: [images[13]._id],
        stock: 45,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 200,
        rating: 4.4,
        reviewCount: 167,
        viewCount: 3200,
        soldCount: 420,
        discount: 0,
      },
      {
        name: "B√°nh m√¨ pate",
        description: "B√°nh m√¨ gi√≤n, pate th∆°m, ch·∫£ l·ª•a",
        price: 35000,
        categoryId: categories[1]._id,
        listProductImage: [images[2]._id],
        stock: 80,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 280,
        rating: 4.5,
        reviewCount: 456,
        viewCount: 8900,
        soldCount: 1450,
        discount: 0,
      },
      {
        name: "Salad t√¥m",
        description: "Salad t∆∞∆°i, t√¥m n∆∞·ªõng, s·ªët chua ng·ªçt",
        price: 85000,
        categoryId: categories[1]._id,
        listProductImage: [images[0]._id],
        stock: 35,
        status: "available",
        preparationTime: "10-12 ph√∫t",
        calories: 260,
        rating: 4.6,
        reviewCount: 234,
        viewCount: 4800,
        soldCount: 560,
        discount: 15,
      },
      {
        name: "B√°nh m√¨ ch·∫£ c√°",
        description: "B√°nh m√¨ ch·∫£ c√° Nha Trang, rau s·ªëng",
        price: 45000,
        categoryId: categories[1]._id,
        listProductImage: [images[2]._id],
        stock: 60,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 320,
        rating: 4.7,
        reviewCount: 345,
        viewCount: 6800,
        soldCount: 980,
        discount: 0,
      },

      // TR√ÅNG MI·ªÜNG - Th√™m m·ªõi
      {
        name: "B√°nh flan caramel",
        description: "B√°nh flan m·ªÅm m·ªãn, s·ªët caramel ng·ªçt ng√†o",
        price: 45000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 40,
        status: "available",
        preparationTime: "3 ph√∫t",
        calories: 280,
        rating: 4.6,
        reviewCount: 234,
        viewCount: 4800,
        soldCount: 650,
        discount: 0,
      },
      {
        name: "Ch√® ƒë·∫≠u xanh",
        description: "Ch√® ƒë·∫≠u xanh m√°t l·∫°nh, n∆∞·ªõc c·ªët d·ª´a",
        price: 35000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 60,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 220,
        rating: 4.5,
        reviewCount: 312,
        viewCount: 6200,
        soldCount: 890,
        discount: 0,
      },
      {
        name: "Ch√® kh√∫c b·∫°ch",
        description: "Ch√® kh√∫c b·∫°ch m√°t l·∫°nh, th·∫°ch d·ª´a",
        price: 40000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 50,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 240,
        rating: 4.7,
        reviewCount: 267,
        viewCount: 5400,
        soldCount: 720,
        discount: 10,
      },
      {
        name: "B√°nh chocolate lava",
        description: "B√°nh chocolate n√≥ng ch·∫£y, kem vani",
        price: 75000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 25,
        status: "available",
        preparationTime: "15-18 ph√∫t",
        calories: 420,
        rating: 4.8,
        reviewCount: 189,
        viewCount: 4100,
        soldCount: 450,
        discount: 0,
      },
      {
        name: "Kem matcha",
        description: "Kem matcha Nh·∫≠t B·∫£n, ƒë·∫≠m ƒë√†",
        price: 50000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 45,
        status: "available",
        preparationTime: "3 ph√∫t",
        calories: 260,
        rating: 4.7,
        reviewCount: 223,
        viewCount: 4900,
        soldCount: 580,
        discount: 0,
      },
      {
        name: "B√°nh crepe s·∫ßu ri√™ng",
        description: "B√°nh crepe m·ªèng, s·∫ßu ri√™ng th∆°m l·ª´ng",
        price: 60000,
        categoryId: categories[2]._id,
        listProductImage: [images[5]._id],
        stock: 30,
        status: "available",
        preparationTime: "10-12 ph√∫t",
        calories: 380,
        rating: 4.6,
        reviewCount: 178,
        viewCount: 3600,
        soldCount: 420,
        discount: 15,
      },
      {
        name: "B√°nh b√¥ng lan tr·ª©ng mu·ªëi",
        description: "B√°nh b√¥ng lan m·ªÅm, tr·ª©ng mu·ªëi b√©o ng·∫≠y",
        price: 55000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 35,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 340,
        rating: 4.5,
        reviewCount: 145,
        viewCount: 3100,
        soldCount: 380,
        discount: 0,
      },
      {
        name: "Kem d·ª´a",
        description: "Kem d·ª´a t∆∞∆°i m√°t, c·ªët d·ª´a b√©o ng·∫≠y",
        price: 40000,
        categoryId: categories[2]._id,
        listProductImage: [images[12]._id],
        stock: 55,
        status: "available",
        preparationTime: "3 ph√∫t",
        calories: 220,
        rating: 4.6,
        reviewCount: 267,
        viewCount: 5800,
        soldCount: 780,
        discount: 0,
      },

      // ƒê·ªí U·ªêNG - Th√™m m·ªõi
      {
        name: "C√† ph√™ ƒëen ƒë√°",
        description: "C√† ph√™ phin ƒë·∫≠m ƒë√†, kh√¥ng ƒë∆∞·ªùng",
        price: 30000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 120,
        status: "available",
        preparationTime: "5-7 ph√∫t",
        calories: 5,
        rating: 4.7,
        reviewCount: 423,
        viewCount: 9800,
        soldCount: 1650,
        discount: 0,
      },
      {
        name: "C√† ph√™ cappuccino",
        description: "C√† ph√™ espresso, s·ªØa n√≥ng, b·ªçt s·ªØa",
        price: 55000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 90,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 120,
        rating: 4.6,
        reviewCount: 312,
        viewCount: 7200,
        soldCount: 980,
        discount: 0,
      },
      {
        name: "C√† ph√™ latte",
        description: "C√† ph√™ espresso, s·ªØa n√≥ng, ngh·ªá thu·∫≠t latte",
        price: 60000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 85,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 150,
        rating: 4.7,
        reviewCount: 289,
        viewCount: 6800,
        soldCount: 850,
        discount: 10,
      },
      {
        name: "Sinh t·ªë d√¢u t√¢y",
        description: "Sinh t·ªë d√¢u t√¢y t∆∞∆°i, s·ªØa chua",
        price: 50000,
        categoryId: categories[3]._id,
        listProductImage: [images[11]._id],
        stock: 75,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 240,
        rating: 4.6,
        reviewCount: 345,
        viewCount: 7800,
        soldCount: 1120,
        discount: 0,
      },
      {
        name: "Sinh t·ªë xo√†i",
        description: "Sinh t·ªë xo√†i ch√≠n, s·ªØa ƒë·∫∑c",
        price: 48000,
        categoryId: categories[3]._id,
        listProductImage: [images[11]._id],
        stock: 80,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 260,
        rating: 4.7,
        reviewCount: 389,
        viewCount: 8200,
        soldCount: 1250,
        discount: 0,
      },
      {
        name: "N∆∞·ªõc √©p d∆∞a h·∫•u",
        description: "D∆∞a h·∫•u t∆∞∆°i √©p 100%, m√°t l·∫°nh",
        price: 40000,
        categoryId: categories[3]._id,
        listProductImage: [images[11]._id],
        stock: 90,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 100,
        rating: 4.5,
        reviewCount: 234,
        viewCount: 5600,
        soldCount: 780,
        discount: 15,
      },
      {
        name: "N∆∞·ªõc √©p t√°o",
        description: "T√°o t∆∞∆°i √©p 100%, kh√¥ng ƒë∆∞·ªùng",
        price: 42000,
        categoryId: categories[3]._id,
        listProductImage: [images[11]._id],
        stock: 85,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 110,
        rating: 4.6,
        reviewCount: 267,
        viewCount: 6100,
        soldCount: 890,
        discount: 0,
      },
      {
        name: "Tr√† ƒë√†o cam s·∫£",
        description: "Tr√† ƒë√†o th∆°m, cam s·∫£ m√°t l·∫°nh",
        price: 45000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 100,
        status: "available",
        preparationTime: "7-8 ph√∫t",
        calories: 140,
        rating: 4.8,
        reviewCount: 512,
        viewCount: 11200,
        soldCount: 1890,
        discount: 0,
      },
      {
        name: "Tr√† s·ªØa matcha",
        description: "Tr√† matcha ƒë·∫≠m ƒë√†, s·ªØa t∆∞∆°i, tr√¢n ch√¢u",
        price: 50000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 95,
        status: "available",
        preparationTime: "7-8 ph√∫t",
        calories: 280,
        rating: 4.7,
        reviewCount: 445,
        viewCount: 9800,
        soldCount: 1350,
        discount: 10,
      },
      {
        name: "Soda chanh d√¢y",
        description: "Soda m√°t l·∫°nh, chanh d√¢y chua ng·ªçt",
        price: 38000,
        categoryId: categories[3]._id,
        listProductImage: [images[10]._id],
        stock: 110,
        status: "available",
        preparationTime: "5 ph√∫t",
        calories: 120,
        rating: 4.5,
        reviewCount: 312,
        viewCount: 7200,
        soldCount: 980,
        discount: 0,
      },

      // SALAD - Th√™m m·ªõi
      {
        name: "Salad c√° ng·ª´",
        description: "Salad t∆∞∆°i, c√° ng·ª´ n∆∞·ªõng, s·ªët m·∫≠t ong",
        price: 95000,
        categoryId: categories[4]._id,
        listProductImage: [images[6]._id],
        stock: 25,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 320,
        rating: 4.7,
        reviewCount: 189,
        viewCount: 4200,
        soldCount: 450,
        discount: 0,
      },
      {
        name: "Salad g√† n∆∞·ªõng",
        description: "Salad t∆∞∆°i, g√† n∆∞·ªõng m·∫≠t ong, s·ªët chua ng·ªçt",
        price: 90000,
        categoryId: categories[4]._id,
        listProductImage: [images[6]._id],
        stock: 30,
        status: "available",
        preparationTime: "10-12 ph√∫t",
        calories: 380,
        rating: 4.6,
        reviewCount: 234,
        viewCount: 4800,
        soldCount: 560,
        discount: 15,
      },
      {
        name: "Salad tr√°i c√¢y",
        description: "Salad tr√°i c√¢y t∆∞∆°i, s·ªët s·ªØa chua",
        price: 80000,
        categoryId: categories[4]._id,
        listProductImage: [images[7]._id],
        stock: 40,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 200,
        rating: 4.5,
        reviewCount: 178,
        viewCount: 3800,
        soldCount: 480,
        discount: 0,
      },
      {
        name: "Salad quinoa",
        description: "Salad quinoa, rau c·ªß, s·ªët d·∫ßu olive",
        price: 100000,
        categoryId: categories[4]._id,
        listProductImage: [images[7]._id],
        stock: 28,
        status: "available",
        preparationTime: "12-15 ph√∫t",
        calories: 280,
        rating: 4.6,
        reviewCount: 145,
        viewCount: 3200,
        soldCount: 380,
        discount: 20,
      },
      {
        name: "Salad b·∫Øp c·∫£i t√≠m",
        description: "Salad b·∫Øp c·∫£i t√≠m, c√† r·ªët, s·ªët chua ng·ªçt",
        price: 75000,
        categoryId: categories[4]._id,
        listProductImage: [images[0]._id],
        stock: 45,
        status: "available",
        preparationTime: "8-10 ph√∫t",
        calories: 160,
        rating: 4.4,
        reviewCount: 123,
        viewCount: 2800,
        soldCount: 320,
        discount: 0,
      },
    ];

    // G·∫Øn 3 ·∫£nh cho t·ª´ng s·∫£n ph·∫©m (ghi ƒë√® n·∫øu tr∆∞·ªõc ƒë√≥ ch·ªâ c√≥ 1 ·∫£nh)
    const productsDataWithImages = productsData.map((p, idx) => ({
      ...p,
      listProductImage: getImagesForProduct(idx),
    }));

    const insertedProducts = await Product.insertMany(productsDataWithImages, { ordered: false });

    console.log(`‚úÖ ƒê√£ t·∫°o ${insertedProducts.length} products`);
    
    // Verify products were actually inserted
    const count = await Product.countDocuments({});
    console.log(`üì¶ T·ªïng s·ªë products trong database: ${count}`);
    
    console.log("\nüìä TH·ªêNG K√ä:");
    console.log(`   - C√≥ khuy·∫øn m√£i: ${productsDataWithImages.filter((p) => p.discount > 0).length}`);
    console.log(`   - H·∫øt h√†ng: ${productsDataWithImages.filter((p) => p.stock === 0).length}`);
    console.log(`   - Best sellers (sold > 1000): ${productsDataWithImages.filter((p) => p.soldCount > 1000).length}`);
    console.log(`   - Highest rated (4.8+): ${productsDataWithImages.filter((p) => p.rating >= 4.8).length}`);
  } catch (error) {
    console.error("‚ùå L·ªói khi seed products:", error);
    if (error.writeErrors) {
      console.error("Chi ti·∫øt l·ªói:", error.writeErrors);
    }
    throw error;
  }
};

const main = async () => {
  try {
    await connectDB();
    await seedData();
    console.log("\n‚úÖ HO√ÄN T·∫§T!");
    await mongoose.connection.close();
    process.exit(0);
  } catch (error) {
    console.error("‚ùå L·ªói trong main:", error);
    await mongoose.connection.close();
    process.exit(1);
  }
};

main();
